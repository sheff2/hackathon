<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Route Viewer</title>
    <style>
      html, body, #map { height: 100%; margin: 0; padding: 0; }
      .legend { position:absolute; top:12px; left:12px; background:#fff; padding:8px 12px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,.15); font:14px/1.4 system-ui; }
    </style>
    <!-- Load Maps JS with geometry + marker libs -->
    <script defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCkB45eQTx6VTU98khj9YcPSJAazXJmuqE&libraries=geometry,marker&v=weekly&callback=initMap">
    </script>
  </head>
  <body>
    <div id="map"></div>
    <div class="legend">
      <div><strong>Selected route</strong>: solid line</div>
      <div id="stats"></div>
    </div>

    <script>
      // 1) Paste your encoded polyline here (the one you got from Routes API for the picked route)
      //const ENCODED = "YOUR_ENCODED_POLYLINE";

      // (Optional) if you also have distance/duration, set them here:
     // const DISTANCE_METERS = null;   // e.g. 13500
      //const DURATION_ISO = null;      // e.g. "PT10000S"


//test
let ENCODED = "yve|CxzpiNvAe@BkGF?@e@h@EAa@BMZLNBRe@f@oC`@i@\\Wl@Qh@Ef@BnA\\f@DXADIFE@cBUGFiEA?BqAH?FIEePE@A]D?@aBCe@?aACkH@ACQ?cCA[B?AiBC[AaD@??g@GsPIi@J?C}AH[I]GaR@mACsC@A?e@EsBEkGMmMQcQBc@CwAC?Ae@D?E_DBUE{DE?AQD?CcCCUCu@OcODYCOAgBCYE_E?a@C{ACiDC??[B?IkLE?DYA?EkEAsDEoC?iBC?BSA?C}B?[A?Ac@@Y?_AE??g@bB?~DChCE?DN??CtBA?CR??BxCC?ARB|LIXDfAE\\CpAC?MtA?EqDEeEEgEGmEEoFGcFCgA@s@CoGBgBJWGIIR?]F?@]I@?a@LRFIKMEMA_E?eH@YA?BsLDO@eICE?]GAFK?iCrF?xAZzG@d@C`@YTSxGAVMFGXm@IExDyITM@_@hBANBNIRe@PARDp@b@h@qAN{@AgBBe@`@s@Di@?_@f@o@hBaBHKh@e@ZOBI\\]pDeDr@s@dB_BLEn@i@vBC?@L?r@C^CpBE?DPA?E\\@dBC?@\\A?ArBE?Pr@EAOF?Ac@bDEvFMZFNExBEPHHGjAEl@?bAAJC^@|@CH@rDI?BhJQb@?tCELAjGGnFItCE?BJ??CrDE?@H??CvFINFHG`DG?Ej@ACwAIaBNIAoAA}@M?EoDA?GqG@??KB?E}DA@AOBSEsDC@?GJ?AsAE]?qBOkKE??I@?A}@M[LKSuME?AMF@QwKA?@OD?Q}KAeBE_B?c@EaCCMGCAQHCBSKk@IgEOUAiAY@HUKQCYCGVc@JZCu@MTGGT[Aa@Yc@JM{AeBMMo@UAcBIWA_A@MGMGGHKlAYpAa@bCyCFCPRHLdAt@JPB^Pb@j@tBR?vAaDm@yA";
let DISTANCE_METERS = null;
let DURATION_ISO = null;

// Allow passing a route via URL hash: #poly=<enc>&dist=12345&dur=PT1800S
(function applyHashParams() {
  const hash = location.hash ? location.hash.slice(1) : "";
  if (!hash) return;
  const p = new URLSearchParams(hash);
  if (p.get("poly")) ENCODED = decodeURIComponent(p.get("poly"));
  if (p.get("dist")) DISTANCE_METERS = Number(p.get("dist"));
  if (p.get("dur"))  DURATION_ISO = p.get("dur");
})();





      // 2) Google callback
      async function initMap() {
        // Load modular libs (already loaded by query string, but importLibrary provides nice types)
        const [{ Map }] = await Promise.all([
          google.maps.importLibrary("maps")
        ]);
        // Decode the route
        const path = google.maps.geometry.encoding.decodePath(ENCODED);

        // Build map
        const map = new Map(document.getElementById("map"), {
          center: path[0],
          zoom: 13,
          mapId: undefined, // optional: your styled map ID
          clickableIcons: false,
        });

        // Draw selected route
        const poly = new google.maps.Polyline({
          map,
          path,
          strokeWeight: 6,
          strokeOpacity: 1.0
        });

        // Fit bounds
        const bounds = new google.maps.LatLngBounds();
        path.forEach(p => bounds.extend(p));
        map.fitBounds(bounds);

        // Start/end markers
        new google.maps.Marker({ map, position: path[0] });
        new google.maps.Marker({ map, position: path[path.length - 1] });

        // Optional stats
        const statsEl = document.getElementById("stats");
        if (statsEl) {
          const km = DISTANCE_METERS ? (DISTANCE_METERS/1000).toFixed(1)+" km" : "—";
          const mins = DURATION_ISO ? isoToMins(DURATION_ISO)+" min" : "—";
          statsEl.textContent = `Distance: ${km} • Duration: ${mins}`;
        }
      }
      window.initMap = initMap; // expose callback

      function isoToMins(iso) {
        // naive parser for PTxxHxxMxxS
        let s = iso || "PT0S";
        if (!s.startsWith("PT")) return 0;
        s = s.slice(2);
        let n = "", total = 0;
        for (const ch of s) {
          if (/\d/.test(ch)) { n += ch; continue; }
          const v = parseInt(n||"0",10);
          if (ch === "H") total += v*60;
          if (ch === "M") total += v;
          if (ch === "S") total += Math.round(v/60);
          n = "";
        }
        return total;
      }
    </script>
  </body>
</html>